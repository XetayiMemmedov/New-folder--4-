<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div
      style="
        font-size: large;
        align-items: center;
        justify-items: center;
        margin: auto;
        width: 600px;
        height: 400px;
        border: 8px;
        background-color: antiquewhite;
        border-color: black;
        border-radius: 20px;
      "
    >
      <h1 style="padding-top: 20px">Get Jokes</h1>
      <div
        id="jokeQ"
        style="width: 580px; height: 50px; background-color: beige"
      ></div>
      <div
        id="jokeA"
        style="width: 580px; height: 50px; background-color: beige"
      ></div>
      <div class="list-group" style="padding: 20px 0 20px 0">
        <label class="list-group-item">
          <input
            class="form-check-input me-1"
            type="checkbox"
            value="1"
            id="programming"
          />
          Programming
        </label>
        <label class="list-group-item">
          <input
            class="form-check-input me-1"
            type="checkbox"
            value="2"
            id="dark"
          />
          Dark
        </label>
        <label class="list-group-item">
          <input
            class="form-check-input me-1"
            type="checkbox"
            value="3"
            id="Pun"
          />
          Pun
        </label>
      </div>

      <button id="btn" style="height: 30px; width: 100px; border-radius: 20px;">Get Jokes</button>
    </div>
    <script>
      const jokeQ = document.getElementById("jokeQ");
      const jokeA = document.getElementById("jokeA");
      const btn = document.getElementById("btn");
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');

      btn.addEventListener("click", fetchJokes);

      async function fetchJokes() {
        let selected = [];
        checkboxes.forEach((checkbox) => {
          if (checkbox.checked) {
            selected.push(checkbox.id);
          }
        });

        if (selected.length === 0) {
          alert("Please select at least one category.");
          return;
        }

        const categoryString = selected.join(",");
        const url = `https://v2.jokeapi.dev/joke/${categoryString}`;

        try {
          const response = await fetch(url);
          const json = await response.json();

          jokeQ.innerHTML = "";
          jokeA.innerHTML = "";

          if (json.type === "twopart") {
            jokeQ.innerHTML = json.setup;
            jokeA.innerHTML = json.delivery;
          } else if (json.type === "single") {
            jokeQ.innerHTML = json.joke;
          } else {
            jokeQ.innerHTML = "Couldn't fetch a joke.";
          }

          console.log(json);
        } catch (error) {
          console.error("Error fetching joke:", error);
          jokeQ.innerHTML = "Something went wrong.";
        }
      }
    </script>
  </body>
</html>
